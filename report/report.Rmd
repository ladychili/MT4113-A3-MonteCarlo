---
title: "MT4113 - Report"
author: '180024570'
date: "07/11/2018"
output:
  pdf_document:
    extra_dependencies: subfig
    fig_caption: yes
    includes: null
    keep_tex: yes
    latex_engine: xelatex
header-includes:
 \usepackage{booktabs}
 \usepackage{longtable}
 \usepackage{array}
 \usepackage{enumitem} 
 \usepackage{multirow}
 \usepackage[table]{xcolor}
 \usepackage{wrapfig}
 \usepackage{float}
 \floatplacement{figure}{H}
 \usepackage[bottom]{footmisc}
bibliography: reference.bib
csl: harvard.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      include = TRUE)


library(knitr)
library(kableExtra)
```

*I conÔ¨Årm that the following report and associated code is my own work, except where clearly indicated.*


\newpage

\section*{\centering Abstract}

More than 17 million people voted to leave the EU in 2016 Referendum in the UK. This statistical report investigated the difference of approval rates of Brexit in England and the rest of the UK by carrying out both parametric and non-parametric tests. Particularly, Monte Carlo simulation is conducted on the referendum dataset by regions, to research the properties of those statistical tests under a range of different scenarios. *add a bit summary of result*

\newpage
# Motivation

Hundreds of thousands of people marched to London's Parliament Square for a referendum on the final Brexit deal in late October[@BBCNews2018]. In the EU referendum in 2016, approximately 52%, or more than 17 million people in the UK, voted to leave the European Union [@Becker2017]. To investigate what voters in different nations of the UK vote for, the dataset of EU referendum results by regions[@ElectoralCommission2016] are statistically analysed and tested in this report. The dateset contains numerous variates regarding the referendum outcome, yet only *Region* and *Percent Leave* are concerned in terms of our research objectives.

```{r hist, fig.cap="Vote Outcome in England and Non-England Regions"}
include_graphics("../figure/datasetHist.pdf")
```


According to the histogram of leave votes, it seems that England regions tend to be more supportive of Brexit than other regions. Hence, The research question is proposed as that

- *Were approval rates of Brexit greater in England or rest of the UK in 2016 referendum?*

On the basis of our research question, regions are categorized as England or Non-England, thus, One-tail Student's T test and Mann-Whitney U test are chosen to be conducted to compare the difference of mean approval rates of Brexit. Moreover, 1000-iteration Monte Carlo simulations are carried out under a range of scenarios in order to investigate power and size of these tests.

# Methodology

## Data Exploration

By organizing and exploring dataset *Referendum*, the properties of leave vote rates are summarized in table 1. It shows that the Brexit approval rate in England regions was approximate 10% higher than in Non-England regions on average. In general, England tended to leave the EU with leave vote rate more than a half, while other nations tended to remain with leave vote rate less than 50%. In the following sections, scenario design and data simulation are grounded on these properties.

```{r dataset}
summry <- brxData %>% group_by(Region) %>% 
  summarise(n = n(),
            mean = mean(brexitRate),
            sd = sd(brexitRate))

kable(summry, caption = "Summary of Leave Vote Rates in Regions of England and Non-England",
      booktabs = T, longtable = T)
```


## Scenario Design

## Power and Size


# Result and Discussion

The power of parametric and non-parametric tests, in terms of different sample sizes and effect sizes, are calculated based on 1000 simulated datasets, and the result are shown in two tables below.

Stop float! Damn tables

```{r power-tables}
load("../data/6.RData")

header <- c(group1 = 1, group2 = 10)
names(header) <- c("Sample Size", "Effect Size")
kable(pwr, caption = "Power of Student's T Test", booktabs=T, longtable = T) %>% 
  add_header_above(header = header, bold = T)


names(header) <- c("Sample Size", "Effect Size")
kable(pwrNonPar, caption = "Power of Mann-Whitney U Test", booktabs=T, longtable = T) %>% 
  add_header_above(header = header, bold = T)

```



```{r power-plot, fig.cap="Power of Parametric and Non-parametric Tests under Different Scenarios"}
include_graphics("../figure/power.pdf")
```

**Explain the power here**

**Explain the power here**

**Explain the power here**

**Explain the power here**

**Explain the power here**

```{r size-tables}
header <- c(group1 = 1, group2 = 5, group3 = 5)
names(header) <- c("Sample Size","SD Difference","SD Difference(record round to 0)")
kable(siz, caption = "Size of Student's T Test", booktabs=T, longtable = T) %>% 
  add_header_above(header = header, bold = T)


names(header) <- c("Sample Size","SD Difference","SD Difference(record round to 0)")
kable(sizNonPar, format = "latex",
      caption = "Size of Mann-Whitney U Test", booktabs=T, longtable = T) %>% 
  add_header_above(header = header, bold = T) %>% 
  kable_styling(latex_options = c("repeat_header"))

```



```{r size-plot, fig.cap="Size of Parametric and Non-parametric Tests Under Different Scenarios"}
include_graphics("../figure/size.pdf")
```


**Explain the size here**

**Explain the size here**

**Explain the size here**

**Explain the size here**


# Conclusion

Here to draw conclusions! 

Here to draw conclusions! 

Here to draw conclusions! 

Here to draw conclusions! 

Here to draw conclusions! 


\newpage
# Reference

<div id="refs"></div>

# Appendix

